<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> classification | Wonkwon Raymond Lee </title> <meta name="author" content="Wonkwon Raymond Lee"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://wonkwonlee.github.io/blog/2021/classification/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Wonkwon</span> Raymond Lee </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">classification</h1> <p class="post-meta"> Created in April 02, 2021 </p> <p class="post-tags"> <a href="/blog/2021"> <i class="fa-solid fa-calendar fa-sm"></i> 2021 </a>   ·   <a href="/blog/tag/study"> <i class="fa-solid fa-hashtag fa-sm"></i> study</a>   <a href="/blog/tag/note"> <i class="fa-solid fa-hashtag fa-sm"></i> note</a>   ·   <a href="/blog/category/bootcamp"> <i class="fa-solid fa-tag fa-sm"></i> bootcamp</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="분류-classification">분류 Classification</h1> <h2 id="이진-판단-문제-binary-classification">이진 판단 문제 Binary Classification</h2> <ul> <li>이진 판단 문제란 예, 아니오 혹은 0, 1 같은 두 가지 값에 대해서 하나로 답하는 문제이다.</li> <li>하지만 이진 판단 문제를 신경망으로 해결하는 것은 까다로운 부분이 존재한다. <ul> <li>가중치와 편향을 이용하는 퍼셉트론의 선형 연산을 살펴보면 하나의 값 만을 출력한다.</li> <li>즉 두 가지 값으로 결과를 제한할 수 없다.</li> </ul> </li> <li>방법은 <em>선형 연산에서는 범위에 제한이 없는 실숫값을 계산하되, 이를 확률값의 성질에 맞게 즉 0~1 사이의 값을 갖도록 변환</em>해주는 비선형 활성화 함수, <strong>시그모이드(sigmoid) 함수</strong>를 사용하는 것이다.</li> </ul> <p><img src="https://user-images.githubusercontent.com/28593767/112778597-d85aae80-907f-11eb-8d5a-5e752744edc5.png" alt="cross"></p> <ul> <li> <em>신경망의 예측값에 따른 확률 분포와 실제 결괏값에 따른 확률 분포 사이의 각 확률 분포가 얼마나 다른지를 숫자 하나로 표현</em>해주는 <strong>교차 엔트로피(Cross Entropy)</strong> 라는 개념으로 풀 수 있다.</li> </ul> <h2 id="시그모이드-함수-sigmoid-function">시그모이드 함수 Sigmoid Function</h2> <p><img src="https://user-images.githubusercontent.com/28593767/112778601-da247200-907f-11eb-8f64-2dfaab391360.png" alt="sig"></p> <ul> <li>시그모이드 함수는 <strong>범위에 제한이 없는 임의의 실숫값을 입력으로 받아 이 값을 확률값의 범위에 해당하는 0과 1 사이의 값으로 다시 연산을 수행</strong>한다. <ul> <li>즉, 선형 연산 결과가 아무리 크다 해도 입력으로 받아 처리할 수 있다.</li> </ul> </li> <li>시그모이드 함수는 <strong>입력값(x)</strong> 을 답이 참일 <strong>가능성(odds)</strong> 에 대해서 <strong>로짓(logit)</strong> 으로 표시한 값이라고 간주한다. <ul> <li>로짓이란 실제 표현하려는 값(odds)을 로그값으로 표현한 것으로 시그모이드 함수는 이 로짓값을 확률값으로 변환해주는 함수이다.</li> </ul> </li> <li>로짓값으로 표시를 하게 되면 <em>넓은 범위의 값을 간단하게 표현</em>할 수 있고 값의 변화를 <em>변화량보다 변화 비율관점에서 더 민감하게 포착</em>할 수 있다.</li> </ul> <h3 id="시그모이드-함수의-일반화-generalization-of-sigmoid-function">시그모이드 함수의 일반화 Generalization of Sigmoid Function</h3> <ul> <li>참일 가능성과 거짓일 가능성의 로짓값이 각각 x와 0이므로 거짓인 경우의 실제 확률은 <em>P_F = α</em> 이고 참인 경우의 실제 확률은 <em>P_T = αe^x</em> 가 된다.</li> </ul> <p><img width="495" alt="sig_cal" src="https://user-images.githubusercontent.com/28593767/112779559-f6291300-9081-11eb-9c9e-2848441989c5.png"></p> <h2 id="정보-엔트로피-information-entropy">정보 엔트로피 Information Entropy</h2> <ul> <li> <em>확률 분포의 무질서도나 불확실성 혹은 정보 표현의 부담 정도</em>를 나타내는 개념을 <strong>정보 엔트로피 혹은 섀넌 엔트로피(Shannon Entropy)</strong> 라고 한다.</li> <li>정보 이론은 <em>신호에 존재하는 정보의 양을 측정하는 이론</em>으로 정보의 양은 간단히 말해 놀람의 정도라고 할 수 있다.</li> <li>예를 들어 전구가 표현할 수 있는 단위 정보수는 2개이니 전구가 1개면 표현 범위는 2, 2개면 4개, 3개면 8개라 할 수 있다.</li> </ul> <p><img width="1159" alt="info" src="https://user-images.githubusercontent.com/28593767/112780934-d515f180-9084-11eb-8a3a-d0c816f60feb.png"></p> <ul> <li>이러한 정보량의 개념은 각 경우에 대한 확률이 균일하지 않은 확률포 분포에도 확장하여 적용할 수 있다.</li> <li> <strong>정보량의 평균(기댓값)을 정보 엔트로피</strong>라고 하며 보통 <em>H</em>라고 표현한다.</li> </ul> <p><img src="https://user-images.githubusercontent.com/28593767/112787103-c5050e80-9092-11eb-9411-9dc396d1740b.png" alt="log"> <img width="292" alt="h" src="https://user-images.githubusercontent.com/28593767/112787107-c6363b80-9092-11eb-87af-1010a7bbb06e.png"></p> <ul> <li>로그의 밑이 2인 경우 단위를 <strong>섀넌(shannon)</strong> 또는 <strong>비트(bit)</strong> 라고 한다.</li> <li>자연상수를 밑으로 할 경우 <strong>내트(nat)</strong> 라고 부르고 머신러닝에서는 대개 밑을 자연상수로 사용한다.</li> </ul> <h2 id="교차-엔트로피-cross-entropy">교차 엔트로피 Cross Entropy</h2> <p><img width="334" alt="cross_ent" src="https://user-images.githubusercontent.com/28593767/112788131-1e6e3d00-9095-11eb-9b7a-ca7a0992a1ce.png"></p> <ul> <li>교차 엔트로피는 두 가지 확률 분포가 얼마나 비슷한 지를 숫자 하나로 나타내는 개념이다.</li> <li>정보량을 제공하는 확률 분포와 가중평균 계산에 사용되는 확률 분포를 서로 다르게 설정하여 정보량의 기댓값을 구하는 방식으로 정의된다.</li> <li>다시 말해, 교차 엔트로피는 틀릴 수 있는 정보를 가지고 구한 엔트로피, 즉 정보량이라고 할 수 있다.</li> <li>딥러닝에서 정보량은 신경망을 통해서 예측한 값, 즉 틀릴 수 있는 정보에 대한 기댓값이다.</li> </ul> <h3 id="교차-엔트로피의-특징">교차 엔트로피의 특징</h3> <p><img width="322" alt="cross" src="https://user-images.githubusercontent.com/28593767/112787877-8b350780-9094-11eb-9315-f0aa601eb813.png"> <img width="426" alt="cross2" src="https://user-images.githubusercontent.com/28593767/112787880-8cfecb00-9094-11eb-855a-e9fcc206b6cf.png"></p> <ul> <li>딥러닝의 예측이 완전히 빗나가게 되면 교차 엔트로피값은 무한대이지만 어느정도 학습이 된 경우라면 교차 엔트로피의 값은 엔트로피 값으로 수렴한다.</li> <li>학습이 완벽하게 진행된 경우라면 교차 엔트로피와 엔트로피는 같은 값을 갖게 된다.</li> <li>따라서, <strong>교차 엔트로피는 두 확률분포가 서로 얼마나 다른지를 나타내주는 정량적 지표 역할을 수행</strong>한다.</li> </ul> <p><img width="1229" alt="ex" src="https://user-images.githubusercontent.com/28593767/112788135-20380080-9095-11eb-8867-14b7fb8029ce.png"></p> <ul> <li>경기 결과에 관한 엔트로피는 1.006, 각 교차 엔트로피는 1.032, 1.053으로 <em>엔트로피값에 더 수렴한 이즈리얼이 더 정확하게 예측을 수행</em>했다.</li> </ul> <h3 id="딥러닝에서의-교차-엔트로피">딥러닝에서의 교차 엔트로피</h3> <ul> <li>딥러닝 모델의 추정 확률 분포 Q, 그리고 미지의 확률 분포 P에 대해서 교차 엔트로피를 계산하고 이 교차 엔트로피가 낮아지는 쪽으로 모델의 추정 확률 분포 Q를 꾸준히 개선함으로 확률 분포 Q를 확률 분포 P에 가깝게 접근시켜 갈 수 있다.</li> <li>이것이 <strong>이진 판단에서의 신경망을 학습시킬 수 있는 원리</strong>가 된다.</li> </ul> <h2 id="시그모이드-함수와-교차-엔트로피의-편미분">시그모이드 함수와 교차 엔트로피의 편미분</h2> <ul> <li>이진 판단 문제에 대한 정답으로 z가 주어질 때 데이터의 결과가 참일 확률은 <em>P_T = z</em>, 거짓일 확률은 <em>P_F = 1 - z</em> 라고 표현할 수 있다.</li> <li>어떠한 데이터에 대해 신경망 회로의 출력 t가 로짓값 x로 계산되었다고 할 때 신경망 예측에 대한 확률값은 <em>Q_T = σ(x)</em> 그리고 <em>Q_F = 1 - σ(x)</em>로 표현할 수 있다.</li> <li>이 때 교차 엔트로피의 정의식 <em>H(P, Q)</em> 에 위 확률값들을 대입하면 H는 다음과 같다. <ul> <li><img width="673" alt="cross" src="https://user-images.githubusercontent.com/28593767/112924916-f392f000-914b-11eb-9d36-e938211b0e17.png"></li> </ul> </li> <li>정리한 교차 엔트로피에 시그모이드 함수 <em>σ(x) = 1/(1+e^-x)</em> 를 대입하면 다음과 같다. <ul> <li><img width="584" alt="cross2" src="https://user-images.githubusercontent.com/28593767/112924921-f4c41d00-914b-11eb-9d5e-cb55882915fb.png"></li> </ul> </li> <li>일반적으로 <em>이진 판단 문제의 정답값은 0 혹은 1</em>이므로 실제 정답 z에 0과 1을 대입하면 다음과 같다. <ul> <li><img width="565" alt="cross3" src="https://user-images.githubusercontent.com/28593767/112924931-f68de080-914b-11eb-823c-9380c6b5d78f.png"></li> </ul> </li> <li>마지막으로 이진 분류 신경망의 학습을 위해 시그모이드 함수에 대한 교차 엔트로피의 편미분을 구하면 다음과 같다 (z는 편미분이기에 상수로 취급). <ul> <li><img width="574" alt="cross4" src="https://user-images.githubusercontent.com/28593767/112924934-f7267700-914b-11eb-99d9-ae1687d8ae27.png"></li> </ul> </li> </ul> <h3 id="오버플로우-overflow">오버플로우 Overflow</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">sigmoid_A</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span>
<span class="nf">sigmoid_A</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">inf</span>
<span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">6</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel_launcher</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span> <span class="nb">RuntimeWarning</span><span class="p">:</span> <span class="n">overflow</span> <span class="n">encountered</span> <span class="ow">in</span> <span class="n">exp</span> <span class="n">after</span> <span class="n">removing</span> <span class="n">the</span> <span class="n">cwd</span> <span class="k">from</span> <span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span>
</code></pre></div></div> <ul> <li>파이썬을 활용해 시그모이드 함수를 돌리다보면 종종 <strong>오버플로우 문제</strong>가 발생한다.</li> <li>입력값 x에 큰 음수가 들어오는 경우 경고가 발생하고 학습이 종료될 수 도 있다. <ul> <li>반면 큰 음수값이 아닌 큰 양수값이 들어오는 경우에는 결괏값이 정상적으로 출력된다.</li> </ul> </li> <li>이러한 오버플로우 문제를 방지하기 위해서는 시그모이드 함수의 <em>분자와 분모에 e^x를 곱해 식을 재정의</em>하는 것으로 해결할 수 있다. <ul> <li><img width="290" alt="over_sig" src="https://user-images.githubusercontent.com/28593767/112924991-12918200-914c-11eb-92c5-42cd9c2f4bd8.png"></li> </ul> </li> <li> <p>시그모이드 함수의 교차 엔트로피 함수 역시 입력값에 큰 음수가 들어오는 경우 inf 출력 및 오버플로우 문제가 발생한다.</p> <ul> <li>마찬가지로 식을 정리해서 해결할 수 있다.</li> <li><img width="1129" alt="over_cross" src="https://user-images.githubusercontent.com/28593767/112924995-13c2af00-914c-11eb-8ce7-eb43833644c3.png"></li> </ul> </li> <li>입력값을 양수식과 음수식에 따라 나눠 대입하는 것은 처리 과정이 너무 복잡하기 때문에 양수식과 음수식을 합쳐 새로운 식을 만들면 다음과 같다. <ul> <li><img width="637" alt="new_eq" src="https://user-images.githubusercontent.com/28593767/112925001-158c7280-914c-11eb-872a-05087e3b3a27.png"></li> <li>새로운 수식은 음수값과 양수값 모두 대응이 가능하고, 이 변형된 수식과 기존 수식에 대하여 같은 값으로 음수, 양수, 0을 대입하면 모두 같은 값이 나온다. <ul> <li><img width="918" alt="eq_ex" src="https://user-images.githubusercontent.com/28593767/112925020-2341f800-914c-11eb-8dde-d1f68bb54e83.png"></li> </ul> </li> </ul> </li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">maximum</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></div> <h2 id="정확도-계산-함수">정확도 계산 함수</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">eval_accuracy</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">estimate</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">greater</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">answer</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">greater</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">equal</span><span class="p">(</span><span class="n">estimate</span><span class="p">,</span> <span class="n">answer</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span>
</code></pre></div></div> <ul> <li>기존의 이진 판단 문제의 <strong>정확도(Accuracy)</strong> 를 측정하는 과정은 np.equal() 을 이용하여 신경망의 연산 결과와 실제 정답의 일치 여부를 판단하고 이 값을 평균내서 최종 정확도를 산출한다.</li> <li>하지만 <em>데이터의 분포도에 따라서 정확도를 측정하는 방식에 문제가 있기 때문에 신경망의 성능을 더욱 잘 보여줄 수 있는 또 다른 평가 지표가 필요</em>하다. <ul> <li>예를 들어 남자와 여자의 비율이 9대1 정도의 차이라면 신경망은 남자라고 답하기만 해도 90%의 정확도를 얻게 된다.</li> </ul> </li> <li>정확도를 구하는 과정에서 단순히 실제 정답과 신경망의 예측결과만 비교하면 이러한 착시 현상이 발생한다.</li> </ul> <blockquote> <p>TP : 신경망의 추측이 <em>참(P)</em> 이며, 데이터의 정답 또한 <em>참(T)</em> 으로 정확하게 평가한 결과 <strong>(True Positive)</strong></p> <p>TN : 신경망의 추측이 <em>거짓(N)</em> 이며, 데이터의 정답은 <em>참(T)</em> 으로 부정확하게 평가한 결과 <strong>(True Negative)</strong></p> <p>FP : 신경망의 추측이 <em>참(P)</em> 이며, 데이터의 정답은 <em>거짓(F)</em> 으로 부정확하게 평가한 결과 <strong>(False Positive)</strong></p> <p>FN : 신경망의 추측이 <em>거짓(N)</em> 이며, 데이터의 정답 또한 <em>거짓(F)</em> 으로 정확하게 평가한 결과 <strong>(False Negative)</strong></p> </blockquote> <ul> <li>대표적인 지표에는 <strong>정밀도(Precision)</strong> 와 <strong>재현율(Recall)</strong> 이 있다. <ul> <li><img width="1131" alt="precision_recall" src="https://user-images.githubusercontent.com/28593767/113079577-47ffa380-9210-11eb-86e4-984e6cf94c18.png"></li> <li>정밀도는 분모에 <em>TP + FP</em>, 즉 신경망이 참으로 예측한 것 가운데 실제 정답이 참 <strong><em>TP</em></strong> 인 비율을 의미한다. <ul> <li>TP / (TP + FP)</li> </ul> </li> <li>재현율은 분모에 <em>TP + FN</em>, 거꾸로 실제 정답이 참인 것들 가운데 신경망이 참 <strong><em>TP</em></strong> 으로 예측한 비율을 의미한다. <ul> <li>TP / (TP + FN)</li> </ul> </li> <li>정밀도와 재현율 중 하나의 값만을 높이는 것은 쉽지만 하나의 값만을 높이게 되면 다른 하나의 값이 떨어지게 되는 현상이 발생한다.</li> </ul> </li> <li> <p>반면 정확도는 오히려 단순하게 모든 지표를 분모에 두고 <em>TP + TN</em> 을 분자에 두어 계산한다.</p> <ul> <li><img width="1001" alt="accu" src="https://user-images.githubusercontent.com/28593767/113079795-b04e8500-9210-11eb-91ea-d46ff157ea3e.png"></li> </ul> </li> <li>정밀도와 재현율의 <strong>조화 평균(F1 score)</strong> 을 정확도 대신 사용되기도 한다.</li> <li>조화 평균은 <em>역수의 차원에서 평균을 구하고 다시 역수</em>를 취해 원래 차원의 값으로 돌아오게 하여 구할 수 있다.</li> </ul> <p><img src="https://user-images.githubusercontent.com/28593767/112940203-ca805880-9167-11eb-9ad1-895a6674cb67.png" alt="f1"></p> <h2 id="다중-선택-분류-multi-class-classification">다중 선택 분류 Multi-Class Classification</h2> <blockquote> <p>다중 선택 분류 문제는 <em>몇 가지 정해진 후보 가운데 하나를 선택</em>하여 답을 하는 문제이다.</p> <p>만약 우리가 철판의 불량 여부를 판정해야 한다면 이는 이진 판단 문제에 속하겠지만 불량 유형을 가려내 답을 해야한다면 선택분류 문제에 속한다고 할 수 있다.</p> </blockquote> <ul> <li>다중 선택 분류는 후보 항목이 여럿이긴 하지만 여러모로 이진 판단과 성격이 비슷하다. <ul> <li>하지만 이진 판단처럼 신경망 출력이 직접적으로 후보 항목의 번호를 지정하거나 각 후보 항목의 확률값을 계산하기는 어렵다.</li> </ul> </li> <li>다중 선택 분류 신경망은 이진 판단처럼 <em>각 후보 항목에 대한 로그 척도의 상대적 추천 강도, 즉 로짓값을 추정하도록 구성</em>된다. <ul> <li>이 때 <em>퍼셉트론 하나가 후보 하나에 대한 로짓값을 출력</em>한다.</li> </ul> </li> <li>따라서 <strong>다중 선택 분류를 수행하려면 다중 선택 분류 후보 수 만큼의 퍼셉트론이 필요</strong>하다.</li> <li>로짓값은 상대적인 가능성을 로그를 이용해 나타낸 값이고 다중 선택 분류에서 로짓값의 표현 대상은 각 후보 항목을 답으로 추정할 확률이다.</li> </ul> <p><img width="697" alt="mcc" src="https://user-images.githubusercontent.com/28593767/113092170-72f5f180-9228-11eb-9020-bd2b22a99408.png"></p> <h3 id="다중-선택-분류의-학습">다중 선택 분류의 학습</h3> <ul> <li>다중 선택 분류에서는 <em>로짓값 사이의 차이</em>가 중요하다.</li> <li>다중 선택 분류 신경망을 학습시키기 위해서는 <em>각 로짓값에 대한 값을 먼저 구한 후 각 로짓값에 대한 확률을 연산</em>해야 한다.</li> <li>로짓값을 굳이 확률로 변환하는 이유는 딥러닝의 학습을 위해 필요하기 때문이다.</li> <li>로짓값을 학습시킬만한 마땅한 방법이 없었지만 확률분포와 교차 엔트로피 개념이 더해지게 되어 학습을 할 수 있게 되었다. <ul> <li> <em>신경망이 추정한 확률 분포와 정답이 나타내는 확률 분포 사이의 교차 엔트로피를 구해 교차 엔트로피를 손실 함수 삼아 학습을 수행</em>하게 되면 신경망이 연산한 값을 바탕으로 출력한 확률 분포, 즉 선택은 점점 정답에 근접 시킬 수 있게 된다.</li> </ul> </li> <li>이러한 다수의 후보 항목들에 대한 로짓값 벡터를 확률 분포 벡터로 변환해주는 <strong>소프트맥스(Softmax) 함수</strong>와 구해진 확률 분포와 정답에 나타난 확률 분포 사이의 교차 엔트로피를 계산해주는 함수 <strong>소프트맥스 교차 엔트로피(Softmax Cross Entropy)</strong> 가 필요하게 되었다.</li> </ul> <h2 id="소프트맥스-함수-softmax-function">소프트맥스 함수 Softmax Function</h2> <p><img width="1114" alt="softmax" src="https://user-images.githubusercontent.com/28593767/113092182-76897880-9228-11eb-96d7-5d199a10d3be.png"></p> <ul> <li>소프트맥스 함수는 로짓값 벡터를 확률 분포 벡터로 변환해주는 비선형 활성화 함수이다.</li> <li>그림을 보면 변환된 로짓값을 바탕으로 소프트맥스 함수를 통과시켜 확률값으로 변환하는 과정이 추가되었다.</li> <li>즉, 소프트맥스 함수는 <strong>기존 상대적 가능성 비율에서 확률값으로 전환시켜 주는 역할</strong>을 수행하고 수식으로 나타내면 다음과 같다. <ul> <li><img width="328" alt="softmax_eq" src="https://user-images.githubusercontent.com/28593767/113092184-77baa580-9228-11eb-8176-6addba4d3b4a.png"></li> </ul> </li> <li>문제는 소프트맥스의 함수 또한 시그모이드 함수와 같이 오버플로우 문제가 발생할 수 있다는 점이다.</li> </ul> <h3 id="소프트맥스-함수의-변형식">소프트맥스 함수의 변형식</h3> <p><img width="997" alt="softmax_eq2" src="https://user-images.githubusercontent.com/28593767/113092185-77baa580-9228-11eb-9968-51ffa55e2645.png"></p> <ul> <li>오버플로우 문제를 해결하기 위해서 <em>x_i</em> 의 최댓값을 <em>x_k</em> 라 할 때 소프트맥스 정의식에서 분자와 분모를 동시에 <em>e^xk</em> 로 나누는 방법이 쓰인다.</li> <li>이로써, 분자와 분모의 어느 항도 지나치게 커질 수 없게 되며 자연스럽게 오버플로우 문제가 사라지게 된다.</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">max</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>           <span class="c1"># Max value
</span>    <span class="n">exp_arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">arr</span> <span class="o">-</span> <span class="n">max_val</span><span class="p">)</span> <span class="c1"># Prevent overflow
</span>    <span class="n">y</span> <span class="o">=</span> <span class="n">exp_arr</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">exp_arr</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y</span>

</code></pre></div></div> <h3 id="소프트맥스-함수의-편미분">소프트맥스 함수의 편미분</h3> <ul> <li>소프트맥스 함수는 벡터를 입력으로 받아 벡터를 출력하게 된다.</li> <li>이러한 성질 때문에 벡터 성분 간의 편미분이 일대일 혹은 다대일의 구조가 아닌 <strong>다대다</strong>의 관계가 되면서 편미분 과정이 상당히 복잡하다. <ul> <li>다행히 이러한 소프트맥스의 편미분 계산 과정은 딥러닝 학습에 거의 이용되지 않는다.</li> </ul> </li> </ul> <h2 id="소프트맥스-교차-엔트로피-softmax-cross-entropy">소프트맥스 교차 엔트로피 Softmax Cross Entropy</h2> <p><img width="296" alt="ce1" src="https://user-images.githubusercontent.com/28593767/113092541-252db900-9229-11eb-87ef-4c2219184cda.png"></p> <ul> <li>교차 엔트로피의 수식에서 신경망의 추론 부분인 <em>Q</em>는 로짓 벡터에 소프트맥스 함수를 적용한 결과이기에 확률의 형태로 값이 출력되며 모든 원소값이 항상 0보다 크고 1보다 작은값을 갖는다.</li> <li>다만 신경망의 연산결과를 통해 얻어진 로짓값 자체가 매우 작은 값을 갖게 된다면 표현 범위의 문제로 오류가 발생할 수 있다.</li> <li>따라서 교차 엔트로피의 식에 아주 작은 양수값(ε)을 도입하여 식을 재정의해야 한다.</li> </ul> <p><img width="577" alt="ce2" src="https://user-images.githubusercontent.com/28593767/113092545-265ee600-9229-11eb-84a3-fdba33f059b7.png"></p> <ul> <li>ε을 넣어 계산을 진행하면 어지히 큰 q_i 값에 대해서는 아주 작은 차이를 주고, 반대로 0에 매우 가까운 q_i 값은 일정 값으로 내려가지 못하게 하한선 역할을 수행하여 오류를 방지할 수 있다.</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/mapping-the-mind-of-a-large-language-model-anthropic/">Mapping the Mind of a Large Language Model \ Anthropic</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/generative-adversarial-network/">generative adversarial network</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/reinforcement-learning/">reinforcement learning</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/database/">database</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/natural-language-processing/">natural language processing</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Wonkwon Raymond Lee. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-publications",title:"publications",description:"publications in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"projects",description:"A collection of my projects.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-repositories",title:"repositories",description:"A brief showcase of my repositories.",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-cv",title:"cv",description:"Professional Curriculum Vitae",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"dropdown-publications",title:"publications",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-projects",title:"projects",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-blog",title:"blog",description:"",section:"Dropdown",handler:()=>{window.location.href="/blog/"}},{id:"post-mapping-the-mind-of-a-large-language-model-anthropic",title:'Mapping the Mind of a Large Language Model  Anthropic <svg width="1.2rem" height="1.2rem" top=".5rem" viewbox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg>',description:"We have identified how millions of concepts are represented inside Claude Sonnet, one of our deployed large language models. This is the first ever detailed look inside a modern, production-grade large language model.",section:"Posts",handler:()=>{window.open("https://www.anthropic.com/research/mapping-mind-language-model","_blank")}},{id:"post-generative-adversarial-network",title:"generative adversarial network",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/generative-adversarial-network/"}},{id:"post-reinforcement-learning",title:"reinforcement learning",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/reinforcement-learning/"}},{id:"post-database",title:"database",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/database/"}},{id:"post-natural-language-processing",title:"natural language processing",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/natural-language-processing/"}},{id:"post-recurrent-neural-network",title:"recurrent neural network",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/recurrent-neural-network/"}},{id:"post-convolutional-neural-network",title:"convolutional neural network",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/convolutional-neural-network/"}},{id:"post-linear-algebra",title:"linear algebra",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/linear-algebra/"}},{id:"post-adaptive-moments-estimation",title:"adaptive moments estimation",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/adaptive-moments-estimation/"}},{id:"post-shortest-path-algorithm",title:"shortest path algorithm",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/shortest-path-algorithm/"}},{id:"post-dynamic-programming",title:"dynamic programming",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/dynamic-programming/"}},{id:"post-search-algorithm",title:"search algorithm",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/search-algorithm/"}},{id:"post-multi-layer-perceptron",title:"multi layer perceptron",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/multi-layer-perceptron/"}},{id:"post-classification",title:"classification",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/classification/"}},{id:"post-tree",title:"tree",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/tree/"}},{id:"post-sorting-algorithm",title:"sorting algorithm",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/sorting-algorithm/"}},{id:"post-regression-analysis",title:"regression analysis",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/regression-analysis/"}},{id:"post-stack-and-queue",title:"stack and queue",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/stack-and-queue/"}},{id:"post-jupyter-and-markdown",title:"jupyter and markdown",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/jupyter-and-markdown/"}},{id:"post-dfs-and-bfs",title:"dfs and bfs",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/dfs-and-bfs/"}},{id:"post-single-layer-perceptron",title:"single layer perceptron",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/single-layer-perceptron/"}},{id:"post-linear-regression",title:"linear regression",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/linear-regression/"}},{id:"post-foundations-of-mathematics",title:"foundations of mathematics",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/foundations-of-mathematics/"}},{id:"post-foundations-of-artificial-intelligence",title:"foundations of artificial intelligence",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/foundations-of-artificial-intelligence/"}},{id:"post-differential",title:"differential",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/differential/"}},{id:"post-complexity",title:"complexity",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2021/complexity/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-out-of-distribution-robustness-evaluation-of-state-of-the-art-vision-models",title:"Out-of-distribution Robustness Evaluation of State-of-the-art Vision Models",description:"Research project comparing the robustness of 58 computer vision models",section:"Projects",handler:()=>{window.location.href="/projects/1_ood/"}},{id:"projects-time-series-medical-image-classification",title:"Time-series Medical Image Classification",description:"Image Classification Model for Temporal Disease Progression of Chest X-ray dataset",section:"Projects",handler:()=>{window.location.href="/projects/2_timeseries_medical/"}},{id:"projects-epistemic-parity-reproducibility-as-an-evaluation-metric-for-differential-privacy",title:"Epistemic Parity: Reproducibility as an Evaluation Metric for Differential Privacy",description:"A benchmark and evaluation for reproducibility in differential privacy with state-of-the-art DP synthesizers.",section:"Projects",handler:()=>{window.location.href="/projects/3_synrd/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%77%6F%6E%6B%77%6F%6E.%6C%65%65@%6E%79%75.%65%64%75","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=xXZLYFwAAAAJ","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/wonkwonlee","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/wonkwon-lee","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>